**本文采用kubeadm方式搭建高可用k8s集群，k8s集群的高可用实际是k8s各核心组件的高可用，这里使用主备模式，架构如下**

<a href="https://ibb.co/HDBwm5p"><img src="https://i.ibb.co/3y46tgY/three-master.png" alt="three-master" border="0"></a>


* [1. 部署环境](#1 部署环境)
* [2. 集群模式高可用架构说明](#1-集群模式高可用架构说明)
* [高可用免密码登录配置]()

# 1 部署环境

操作系统|	IP|	           角色|	  CPU核心数	|运行内存	|Hostname|
---|---|---|---|---|---|
CentOS 8|	192.168.33.11 |	Master|	2	 |         2G|	   master|
CentOS 8|	192.168.33.12	| Node1 |	  2|	          4G|	    node1|
CentOS 8	| 192.168.33.13	| Node2	|  2	  |        4G	 |   node2|
CentOS 8	| 192.168.33.14	|Node3|	  2	|          4G	|    node3|
CentOS 8	| 192.168.33.15	| NFS	  |  1	 |         1G	  |   nfs|
CentOS 7	| 192.168.33.16 |	Extend |	2	 |          6G	|    extend|
CentOS 8| 192.168.33.10|master2|2|                  2G  |master2|
CentOS 8| 192.168.33.9|master3|2|                   2G  |master3|
CentOS 8| 192.168.33.130|vip|2|                     2G  |vip|
CentOS 8| 192.168.33.131|client|2|                  2G  |client|
CentOS 8| 192.168.33.132|client|2|                  2G  |lvs-keepalived1|
CentOS 8| 192.168.33.133|client|2|                  2G  |lvs-keepalived2|
---|---|---|---|---|---|

共有9台服务器，3台control plane，3台work，1台client，2台为lvs-keepalived集群



# 2 集群模式高可用架构说明

**k8s集群的高可用实际是k8s各核心组件的高可用，这里使用集群模式(针对apiserver来讲)**



核心组件|	 高可用模式|	    高可用实现方法 |
---|---|---|
Apiserver|集群| lvs + keepalived|
controller-manager|主备| leader election|
scheduler|主备|leader election|
etcd|集群|kubeadm|
---|---|---|
